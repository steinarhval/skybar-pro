<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8" />
  <title>Kontroll</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="app.css" />
</head>

<body>

  <h1>Kontrollpanel</h1>

  <button id="loginBtn">Logg inn med Google</button>
<button id="startSessionBtn">Start ny session</button>
<div id="sessionBox" style="margin-top:20px;"></div>


  <div id="userBox" style="margin-top:20px;"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

  <script src="config.js"></script>
  <script src="app.js"></script>

<script>
  const loginBtn = document.getElementById("loginBtn");
  const userBox = document.getElementById("userBox");
  const startSessionBtn = document.getElementById("startSessionBtn");
  const sessionBox = document.getElementById("sessionBox");

  loginBtn.addEventListener("click", async () => {
    try {
      const user = await App.ensureSignedInWithGoogle();
      userBox.innerHTML = `
        <strong>Innlogget som:</strong><br>
        ${user.displayName}<br>
        ${user.email}<br>
        userId: ${user.uid}
      `;
    } catch (err) {
      console.error(err);
      alert("Innlogging feilet.");
    }
  });

  startSessionBtn.addEventListener("click", async () => {
    try {
      const res = await App.startOrReplaceSession();
      const snap = await res.sessionRef.get();
      const d = snap.data() || {};
      sessionBox.innerHTML = `
        <strong>Session startet:</strong><br>
        sessionId: ${d.sessionId}<br>
        joinCode: ${d.joinCode}<br>
        docPath: sessions/${res.ownerId}
      `;
    } catch (err) {
      console.error(err);
      alert("Kunne ikke starte session.");
    }
  });

  App.auth.onAuthStateChanged((user) => {
    if (user) {
      userBox.innerHTML = `
        <strong>Innlogget som:</strong><br>
        ${user.displayName}<br>
        ${user.email}<br>
        userId: ${user.uid}
      `;
    }
  });
</script>


    App.auth.onAuthStateChanged((user) => {
      if (user) {
        userBox.innerHTML = `
          <strong>Innlogget som:</strong><br>
          ${user.displayName}<br>
          ${user.email}<br>
          userId: ${user.uid}
        `;
      }
    });
  </script>

</body>
</html>
